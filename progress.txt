# Ralph Progress Log
Started: Mon Feb  9 09:09:47 MST 2026
---

## Codebase Patterns
- E2E tests use embedded-postgres on port 15432, database `slurpee_test`
- `TestMain` must call `flag.Parse()` before `testing.Short()` in Go 1.25+
- Migration parser extracts lines between `-- +migrate Up` and `-- +migrate Down` markers
- `truncateAll` uses single TRUNCATE with CASCADE for all tables (faster than individual truncates)
- Seed helpers use `bcrypt.MinCost` for fast test execution (not default cost 10)
- `newTestApp` wires real `db.Queries` to embedded postgres, not mocks
- `seedApiSecret` returns both the db record and the plaintext for use in auth headers

## 2026-02-09 09:15 AM - US-001
- Implemented: E2E test infrastructure with embedded-postgres
- Files changed:
  - `tests/e2e/main_test.go` — TestMain, migration runner, truncateAll, newTestApp, newTestRouter, seed helpers, placeholder test
  - `go.mod` / `go.sum` — added embedded-postgres dependency
- **Learnings for future iterations:**
  - `flag.Parse()` must be called before `testing.Short()` in TestMain (Go 1.25 panics otherwise)
  - embedded-postgres default user/password is `postgres/postgres`
  - Using `bcrypt.MinCost` in seed helpers keeps tests fast vs default cost 10
  - `TRUNCATE ... CASCADE` handles FK dependencies without needing specific ordering
  - pgxpool.Pool satisfies db.DBTX interface, so `db.New(pool)` works directly
---
